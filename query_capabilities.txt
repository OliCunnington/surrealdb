-- secure by default

-- #Allow all query capabilities
-- $ surreal start --allow-all

-- # Explicitly override any allowed query capabilities
-- $ surreal start --allow-guests --deny-all

-- full list
-- https://surrealdb.com/docs/surrealdb/security/capabilities


-- Network access
RETURN http::get('url');
RETURN http::put('url');
RETURN http::post('url');
RETURN http::patch('url');
RETURN http::delete('url');
RETURN http::head('url');

-- # Deny network access to localhost and private IPv4 ranges
-- $ surreal start --allow-net --deny-net "127.0.0.1","localhost","10.0.0.0/8","192.168.0.0/16","172.16.0.0/12"

-- # Allow access to an internal system, but only to port 443
-- $ surreal start --allow-net internal.example.com:433
 
-- # Allow access to some private networks but not to others
-- $ surreal start --allow-net 10.0.0.0/16 --deny-net 10.10.0.0/24


-- guest access
--  denied by default

-- # Allow guest access
-- $ surreal start --allow-guests

-- # Deny guest access
-- $ surreal start --deny-guests


-- functions

-- # Allow all functions except the http family and crypto::md5()
-- $ surreal start --allow-funcs --deny-funcs "http","crypto::md5"

-- # Allow certain custom functions only (all custom functions start with "fn::")
-- $ surreal start --allow-funcs "fn::shared_fn"